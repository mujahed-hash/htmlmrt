"use strict";(self.webpackChunkhmfront=self.webpackChunkhmfront||[]).push([[4069],{4069:(O,u,r)=>{r.r(u),r.d(u,{BuyeritemsModule:()=>M});var c=r(6814),d=r(3403),t=r(5879),p=r(7019),x=r(6627),f=r(2039),l=r(8259),a=r(6223),h=r(617);const v=["loadingIndicator"],g=function(n){return["/buyer/item/view",n]};function b(n,m){if(1&n){const i=t.EpF();t.TgZ(0,"div",8)(1,"div"),t._UZ(2,"img",9),t.qZA(),t.TgZ(3,"div",10)(4,"p"),t._uU(5),t.qZA(),t.TgZ(6,"button",11)(7,"mat-icon",12),t._uU(8,"visibility"),t.qZA(),t._uU(9," View"),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.ALo(12,"currency"),t.qZA(),t.TgZ(13,"div")(14,"p-inputNumber",13),t.NdJ("ngModelChange",function(o){t.CHM(i);const s=t.oxw().$implicit,P=t.oxw();return t.KtG(P.quantities[s.id]=o)}),t.qZA()(),t.TgZ(15,"div",14)(16,"button",15),t.NdJ("click",function(){t.CHM(i);const o=t.oxw().$implicit,s=t.oxw();return t.KtG(s.addProductToCart(o.id))}),t.TgZ(17,"mat-icon",16),t._uU(18,"add_shopping_cart"),t.qZA(),t._uU(19," Add to cart "),t.qZA()()()()}if(2&n){const i=t.oxw().$implicit,e=t.oxw();t.xp6(2),t.s9C("alt",i.prodName),t.Q6J("routerLink",t.VKq(14,g,i.customIdentifer))("src",i.images[0],t.LSH),t.xp6(3),t.Oqu(i.prodName),t.xp6(1),t.Q6J("routerLink",t.VKq(16,g,i.customIdentifer)),t.xp6(5),t.AsE("",t.xi3(12,11,i.prodPrice,"INR"),"/",i.prodSize,""),t.xp6(3),t.Q6J("ngModel",e.quantities[i.id])("showButtons",!0)("min",1)("max",i.countInStock)}}function C(n,m){if(1&n&&(t.TgZ(0,"div",6),t.YNc(1,b,20,18,"div",7),t.qZA()),2&n){const i=m.$implicit;t.xp6(1),t.Q6J("ngIf",i.countInStock>=1)}}function y(n,m){if(1&n){const i=t.EpF();t.TgZ(0,"button",17,18),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.loadProducts())}),t._uU(2," Load More "),t.qZA()}if(2&n){const i=t.oxw();t.Q6J("disabled",i.isLoading)}}const w=[{path:"marketplace",component:(()=>{class n{constructor(i,e,o,s){this.supplyService=i,this.lService=e,this.el=o,this.buyerService=s,this.products=[],this.start=0,this.limit=10,this.isLoading=!1,this.hasMoreProducts=!0,this.quantities={}}ngOnInit(){this.loggedUser=this.lService.getUserIdFromToken(),this.loadProducts(),this.token=localStorage.getItem("token"),console.log(this.quantity),this.products.forEach(i=>{this.quantities[i.id]=this.quantities[i.id]||1})}ngAfterViewInit(){this.initIntersectionObserver(),this.checkContentHeight()}loadProducts(){this.isLoading||!this.hasMoreProducts||(this.isLoading=!0,this.supplyService.getProducts(this.start,this.limit).subscribe(i=>{this.isLoading=!1,i&&Array.isArray(i.products)?(this.products=[...this.products,...i.products],this.products.forEach(e=>{this.quantities[e.id]||(this.quantities[e.id]=1)}),this.start+=this.limit,this.checkContentHeight(),this.hasMoreProducts=i.products.length===this.limit):(console.error("Unexpected response structure:",i),this.checkContentHeight())},i=>{this.isLoading=!1,console.error("Error loading products:",i)}))}checkContentHeight(){const i=this.el.nativeElement.querySelector(".items").offsetHeight,e=window.innerHeight;this.hasMoreProducts=i<e}onResize(){this.checkContentHeight()}initIntersectionObserver(){const i=new IntersectionObserver(e=>{e[0].isIntersecting&&this.hasMoreProducts&&!this.isLoading&&this.loadProducts()},{rootMargin:"100px"});this.loadingIndicator&&i.observe(this.loadingIndicator.nativeElement)}addProductToCart(i){this.buyerService.addToCart(i,this.quantities[i]||1,this.token).subscribe(o=>{console.log(o)},o=>{console.error("Error adding product to cart:",o)})}static#t=this.\u0275fac=function(e){return new(e||n)(t.Y36(p.p),t.Y36(x.n),t.Y36(t.SBq),t.Y36(f.y))};static#i=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-buyeritems"]],viewQuery:function(e,o){if(1&e&&t.Gf(v,5),2&e){let s;t.iGM(s=t.CRH())&&(o.loadingIndicator=s.first)}},hostBindings:function(e,o){1&e&&t.NdJ("resize",function(){return o.onResize()},!1,t.Jf7)},decls:6,vars:2,consts:[[1,"hh"],[1,"items-main"],[1,"items"],["class","item",4,"ngFor","ngForOf"],[1,"itm-btn"],["style","",3,"disabled","click",4,"ngIf"],[1,"item"],["routerLinkActive","router-link-active","class","sub-item","style","",4,"ngIf"],["routerLinkActive","router-link-active",1,"sub-item"],[3,"routerLink","src","alt"],[1,"itemName"],[2,"width","max-content","display","flex","justify-content","center","vertical-align","middle","align-items","center","border","none","border-radius","5px","background-color","#37B7C3","color","white","padding","2px 8px",3,"routerLink"],[2,"color","white","font-size","15px","position","relative","top","0.35rem"],["name","quantity","inputId","minmax","mode","decimal",3,"ngModel","showButtons","min","max","ngModelChange"],[2,"width","max-content","display","flex","align-items","center","margin-top","0.5rem"],[2,"width","100%","display","flex","align-items","center","justify-content","center","border","none","border-radius","5px","background-color","#071952","color","white","padding","3px 8px",3,"click"],[2,"color","#F0DE36"],[3,"disabled","click"],["loadingIndicator",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.YNc(3,C,2,1,"div",3),t.qZA()(),t.TgZ(4,"div",4),t.YNc(5,y,3,1,"button",5),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("ngForOf",o.products),t.xp6(2),t.Q6J("ngIf",o.hasMoreProducts&&!o.isLoading))},dependencies:[c.sg,c.O5,d.rH,d.Od,l.Rn,a.JJ,a.On,h.Hw,c.H9],styles:["img[_ngcontent-%COMP%]{width:10rem;height:10rem;margin-right:.7rem;border-radius:8px}.hh[_ngcontent-%COMP%]{height:100%}p-inputNumber[_ngcontent-%COMP%]{width:5rem;height:2rem}.items-main[_ngcontent-%COMP%]{display:grid;width:80%;overflow-x:hidden}.items[_ngcontent-%COMP%]{display:inline-block;flex-wrap:nowrap;width:100%;margin:2rem}.item[_ngcontent-%COMP%]{width:30%;display:inline-block;margin-bottom:4.5rem;box-sizing:border-box;height:12rem}.itemName[_ngcontent-%COMP%]{font-size:1.2em;margin-bottom:10px;display:block}.truncate-single-line[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.itm-btn[_ngcontent-%COMP%]{width:100%;text-align:center}.itm-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:max-content;padding:5px;position:relative;right:8rem;font-size:large;background-color:#000;color:#fff;border:none;border-radius:5px;margin-bottom:1rem;box-shadow:#32325d40 0 6px 12px -2px,#0000004d 0 3px 7px -3px}.sub-item[_ngcontent-%COMP%]{width:90%;display:flex;padding:8px;margin-bottom:1rem;box-shadow:#32325d40 0 6px 12px -2px,#0000004d 0 3px 7px -3px;overflow:hidden}@media (max-width: 1024px){.item[_ngcontent-%COMP%]{width:45%;margin:0 2.5%}}@media (max-width: 1000px){.items-main[_ngcontent-%COMP%]{width:100%}.item[_ngcontent-%COMP%]{width:48%;margin:0 0 10px;height:15rem}.itm-btn[_ngcontent-%COMP%]{width:100%}.itm-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{right:0}}@media (max-width: 768px){.item[_ngcontent-%COMP%]{width:100%;margin:0 0 20px}}@media screen and (orientation: portrait){.item[_ngcontent-%COMP%]{width:100%;margin:0;margin-bottom:2rem}.sub-item[_ngcontent-%COMP%]{margin-bottom:2rem;margin-left:-.8rem}}@media screen and (max-width: 380px){.sub-item[_ngcontent-%COMP%]{margin-left:-1.1rem}}"]})}return n})()}];let _=(()=>{class n{static#t=this.\u0275fac=function(e){return new(e||n)};static#i=this.\u0275mod=t.oAB({type:n});static#e=this.\u0275inj=t.cJS({imports:[d.Bz.forChild(w),d.Bz]})}return n})(),M=(()=>{class n{static#t=this.\u0275fac=function(e){return new(e||n)};static#i=this.\u0275mod=t.oAB({type:n});static#e=this.\u0275inj=t.cJS({imports:[c.ez,_,l.L$,a.u5,h.Ps]})}return n})()}}]);